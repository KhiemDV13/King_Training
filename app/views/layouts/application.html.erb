<!DOCTYPE html>
<!-- 🟢 Khai báo rằng tài liệu này sử dụng tiêu chuẩn HTML5. -->
<html>

<head>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <title><%= full_title(yield(:title)) %></title>
  <!-- 🟢 Gọi phương thức `full_title(yield(:title))` để tạo tiêu đề trang động. -->
  <meta charset="utf-8">
  
  <!-- 🟢 Include Bootstrap CSS và JS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet" 
        integrity="sha384-4Q6Gf2aSP4eDXB8Miphtr37CMZZQ5oXLH2yaXMJ2w8e2ZtHTl7GptT4jmndRuHDT" 
        crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js" 
          integrity="sha384-j1CDi7MgGQ12Z7Qab0qlWQ/Qqz24Gc6BM0thvEMVjHnfYGF0rmFCozFSxQBxwHKO" 
          crossorigin="anonymous"></script>

  <!-- 🟢 Rails bảo vệ chống CSRF -->
  <%= csrf_meta_tags %>
  <%= csp_meta_tag %>

  <!-- 🟢 Nhúng stylesheet và JavaScript -->
  <%= stylesheet_link_tag 'application', media: 'all', 'data-turbolinks-track': 'reload' %>

  <!-- 🟢 Kiểm tra hỗ trợ HTML5 cho IE cũ -->
  <!--[if lt IE 9]>
  <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/r29/html5.min.js"></script>
  <![endif]-->
  
  <%= render 'layouts/shim' %>
</head>

<body>
  <%= render 'layouts/header' %>
  <!-- 🟢 Chèn header vào trang, chứa logo và thanh điều hướng -->

  <div class="container">
    <!-- 🟢 Kiểm tra xem người dùng có đang đăng nhập không -->
    <% if current_user %>
      <p>Welcome, <%= current_user.name %>!</p>
      <%= link_to "Logout", logout_path, method: :delete, class: "btn btn-danger" %>
      <!-- 🟢 Nếu user đã đăng nhập, hiển thị tên và nút đăng xuất -->
    <% else %>
      <%= link_to "Login", login_path, class: "btn btn-primary" %>
      <!-- 🟢 Nếu chưa đăng nhập, hiển thị nút đăng nhập -->
    <% end %>

    <!-- 🟢 Hiển thị thông báo flash -->
    <% unless flash.empty? %>
      <% flash.each do |key, message| %>
        <div class="alert alert-<%= key == "success" ? "success" : "danger" %>">
          <%= message %>
        </div>
      <% end %>
    <% end %>

    <!-- 🟢 Hiển thị nội dung chính của từng trang -->
    <%= yield %>

    <!-- 🟢 Chèn footer -->
    <%= render 'layouts/footer' %>

    <!-- 🟢 Debug params nếu đang chạy môi trường `development` -->
    <% if Rails.env.development? %>
      <%= debug(params) %>
    <% end %>
  </div>
</body>
</html>
